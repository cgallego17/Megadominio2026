{% extends 'core/dashboard_base.html' %}
{% load crispy_forms_tags %}

{% block dashboard_title %}Configuración cPanel / correo{% endblock %}
{% block dashboard_heading %}Configuración cPanel / correo{% endblock %}
{% block dashboard_desc %}Conexión cPanel y servidores para Outlook (.prf){% endblock %}

{% block dashboard_content %}
{% if messages %}
<div class="mb-4">
    {% for message in messages %}
    <div class="px-4 py-3 rounded-lg {% if message.tags == 'success' %}bg-green-500/10 text-green-400 border border-green-500/30{% else %}bg-gray-800 text-gray-300 border border-gray-700{% endif %}">
        {{ message }}
    </div>
    {% endfor %}
</div>
{% endif %}
<div class="max-w-4xl">
    <div class="bg-gray-900 border border-gray-800 rounded-xl overflow-hidden">
        <div class="p-6">
            <form method="post">
                {% csrf_token %}
                <div class="dash-form space-y-6">
                    <div>
                        <h3 class="text-sm font-bold text-white mb-3">Conexión cPanel</h3>
                        <p class="text-gray-500 text-xs mb-4">Usado al crear/editar/eliminar cuentas de correo en el admin y al cambiar contraseña desde el panel del cliente.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {{ form.sync_enabled|as_crispy_field }}
                            {{ form.host|as_crispy_field }}
                            {{ form.username|as_crispy_field }}
                            {{ form.api_token|as_crispy_field }}
                            {{ form.use_https|as_crispy_field }}
                            {{ form.port|as_crispy_field }}
                            {{ form.timeout|as_crispy_field }}
                            {{ form.mailbox_quota_mb|as_crispy_field }}
                        </div>
                    </div>
                    <div class="border-t border-gray-800 pt-6">
                        <h3 class="text-sm font-bold text-white mb-3">Outlook (.prf)</h3>
                        <p class="text-gray-500 text-xs mb-4">Servidores que se incluyen en el archivo de autoconfiguración que descargan los clientes. Vacío = usar host de correo del servidor.</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {{ form.outlook_imap_host|as_crispy_field }}
                            {{ form.outlook_imap_port|as_crispy_field }}
                            {{ form.outlook_imap_ssl|as_crispy_field }}
                            {{ form.outlook_smtp_host|as_crispy_field }}
                            {{ form.outlook_smtp_port|as_crispy_field }}
                            {{ form.outlook_smtp_ssl|as_crispy_field }}
                        </div>
                    </div>
                </div>
                <div class="flex items-center gap-3 mt-6 pt-6 border-t border-gray-800">
                    <button type="submit" class="inline-flex items-center gap-2 px-6 py-2.5 bg-red-600 text-white text-sm font-semibold rounded-lg hover:bg-red-700 transition">
                        <i class="fas fa-save"></i> Guardar
                    </button>
                    <a href="{% url 'core:dashboard' %}" class="inline-flex items-center gap-2 px-6 py-2.5 bg-gray-800 text-gray-300 text-sm font-semibold rounded-lg hover:bg-gray-700 transition">Volver al dashboard</a>
                </div>
            </form>
        </div>
    </div>
</div>
<style>
    .dash-form label { color: #d1d5db; font-size: 0.875rem; font-weight: 600; }
    .dash-form input, .dash-form select, .dash-form textarea {
        background: #1f2937 !important; border: 1px solid #374151 !important; color: #f3f4f6 !important;
        border-radius: 0.5rem !important; padding: 0.6rem 0.75rem !important; font-size: 0.875rem !important;
    }
    .dash-form input:focus, .dash-form select:focus, .dash-form textarea:focus {
        border-color: #dc2626 !important; box-shadow: 0 0 0 2px rgba(220,38,38,0.15) !important; outline: none !important;
    }
    .dash-form .form-check-input { accent-color: #dc2626; }
    .dash-form .text-muted, .dash-form .form-text { color: #6b7280 !important; font-size: 0.75rem !important; }
    .dash-form .asteriskField { color: #ef4444; }
</style>
{% endblock %}
